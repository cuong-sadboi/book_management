<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Create Rental | Book Management</title>
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
	<link rel="stylesheet" href="css/style.css">
	<link rel="stylesheet" href="css/rental-form.css">
</head>
<body class="bg-light d-flex flex-column min-vh-100">
	<div id="navbarInclude" data-include="../include/navbar.html"></div>
	<div class="layout-wrapper">
		<div id="sidebarInclude" data-include="../include/sidebar.html"></div>
		<div class="sidebar-backdrop" id="sidebarBackdrop"></div>
		<main class="content-area">
			<div class="container">
				<div class="card shadow-sm border-0">
					<div class="card-header bg-white border-0 pb-0">
						<h2 class="h4 mb-0">Create new rental</h2>
					</div>
					<div class="card-body">
						<form id="rentalForm" class="row g-3">
							<!-- User Search Section -->
							<div class="col-12">
								<label class="form-label required">User</label>
								<div class="user-search-container">
									<input type="text" id="userSearchInput" class="form-control" placeholder="Search user by name or email..." autocomplete="off">
									<div id="userSearchResults" class="user-search-results"></div>
								</div>
								<input type="hidden" id="userId" name="user_id">
							</div>

							<!-- Selected User Display -->
							<div class="col-12" id="selectedUserContainer" style="display: none;">
								<div class="selected-user-card d-flex justify-content-between align-items-center">
									<div>
										<strong id="selectedUserName"></strong><br>
										<small class="text-muted" id="selectedUserEmail"></small>
									</div>
									<button type="button" id="clearUserBtn" class="btn btn-sm btn-outline-secondary">Change</button>
								</div>
							</div>

							<!-- New User Form (hidden by default) -->
							<div class="col-12" id="newUserContainer" style="display: none;">
								<div class="new-user-form">
									<h6 class="mb-3"><i class="bi bi-person-plus me-2"></i>Create New User</h6>
									<div class="row g-2">
										<div class="col-md-6">
											<input type="text" id="newUserName" class="form-control" placeholder="Full Name *">
										</div>
										<div class="col-md-6">
											<input type="text" id="newUserUsername" class="form-control" placeholder="Username *">
										</div>
										<div class="col-md-6">
											<input type="email" id="newUserEmail" class="form-control" placeholder="Email *">
										</div>
										<div class="col-md-3">
											<input type="number" id="newUserAge" class="form-control" placeholder="Age">
										</div>
										<div class="col-md-3">
											<input type="text" id="newUserLocation" class="form-control" placeholder="Location">
										</div>
										<div class="col-12">
											<textarea id="newUserNote" class="form-control" rows="2" placeholder="Note (optional)"></textarea>
										</div>
										<div class="col-12">
											<button type="button" id="cancelNewUserBtn" class="btn btn-sm btn-outline-secondary">Cancel</button>
										</div>
									</div>
								</div>
							</div>

							<!-- Due Date -->
							<div class="col-md-6">
								<label for="dueDate" class="form-label required">Due Date</label>
								<input type="datetime-local" id="dueDate" class="form-control" required>
							</div>

							<!-- Notes -->
							<div class="col-12">
								<label for="notes" class="form-label">Notes</label>
								<textarea id="notes" rows="2" class="form-control" placeholder="Optional notes..."></textarea>
							</div>

							<!-- Books Section -->
							<div class="col-12">
								<div class="d-flex justify-content-between align-items-center mb-3">
									<label class="form-label mb-0 required">Books</label>
									<button type="button" id="btnAddBook" class="btn btn-sm btn-outline-primary">
										<i class="bi bi-plus-lg me-1"></i>Add Book
									</button>
								</div>
								<div id="selectedBooksContainer">
									<div id="booksEmptyState" class="books-empty-state">
										<i class="bi bi-book fs-1 mb-2 d-block"></i>
										<p class="mb-0">No books selected. Click "Add Book" to start.</p>
									</div>
								</div>
							</div>

							<div class="col-12 d-flex justify-content-end gap-2 pt-3">
								<a href="index-rental.html" class="btn btn-outline-secondary">Cancel</a>
								<button type="submit" class="btn btn-primary">Create Rental</button>
							</div>
						</form>
					</div>
				</div>
			</div>
		</main>
	</div>
	<div id="footerInclude" class="layout-footer" data-include="../include/footer.html"></div>

	<!-- Book Search Modal -->
	<div class="modal fade" id="bookSearchModal" tabindex="-1">
		<div class="modal-dialog modal-lg modal-dialog-scrollable">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">Select Book</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal"></button>
				</div>
				<div class="modal-body">
					<div class="mb-3">
						<input type="text" id="bookSearchInput" class="form-control" placeholder="Search by title, author, or ISBN...">
					</div>
					<div id="bookSearchResults" style="max-height: 400px; overflow-y: auto;">
						<div class="text-center text-muted py-3"><p>Loading books...</p></div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
	<script src="js/utils.js"></script>
	<script src="js/layout.js"></script>
	<script src="js/create-rental.js"></script>
</body>
</html>
